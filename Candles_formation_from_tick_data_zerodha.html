<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	<title>EzeeTrading.in</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/vendor.css">
    <link rel="stylesheet" href="../css/main.css">

	<meta name="description" content="We at EzeeTrading.in receives lot of requests by our followers. This tool is a part of out Ease of Trading Toolset... So that entry level Retail Participants as well as much more experienced Traders can enjoy seamless Trading experience without looking into technicalities themselves.">
	<meta name="keywords" content="kite, zerodha, upstox, india, discount broker, semi-automated, trading, apis, free api, automated trading apis, stock trading apis, rest api stock market, nse trading api, html5 trading platform, best trading platform, best web trading platform, trade plugin, stock trade button">
	<link rel="image_src" href="Trade_files/logo.png">
	<meta property="og:image" content="Trade_files/logo.png">
	<link rel="icon" type="image/png" href="Trade_files/logo.png">

	<link href="Trade_files/css.css" rel="stylesheet">

	<script async="" src="//www.google-analytics.com/analytics.js"></script>
	<script async="" src="Trade_files/analytics.js"></script>
	<script src="Trade_files/jquery.js"></script>

 	<link type="text/css" rel="stylesheet" href="Trade_files/main.css">

<link rel="shortcut icon" href="Trade_files/logo.png">

<style type="text/css">
upstox-tradebutton {display: block;width: 150px;height: 40px;margin: 5px;cursor:pointer;}
upstox-tradebutton:hover {opacity: 0.9}
upstox-tradebutton[buy] {background-image: url("https://s3.ap-south-1.amazonaws.com/tradebutton/buy.png");} 
upstox-tradebutton[sell] {background-image: url("https://s3.ap-south-1.amazonaws.com/tradebutton/sell.png");} 
upstox-tradebutton[trade] {background-image: url("https://s3.ap-south-1.amazonaws.com/tradebutton/trade.png");};</style>

<style type="text/css">
upstox-tradebutton {display: block;width: 150px;height: 40px;margin: 5px;cursor:pointer;} 
upstox-tradebutton:hover {opacity: 0.9} 
upstox-tradebutton[buy] {background-image: url("https://s3.ap-south-1.amazonaws.com/tradebutton/buy.png");} 
upstox-tradebutton[sell] {background-image: url("https://s3.ap-south-1.amazonaws.com/tradebutton/sell.png");} 
upstox-tradebutton[trade] {background-image: url("https://s3.ap-south-1.amazonaws.com/tradebutton/trade.png");};
</style>

 	<!-- [head] -->
</head>
<body>

<div class="container sections">
	<section class="row large">
		<!--<h3> Powered by...<h3> -->
		<h1 style="color:white;" class="title">EzeeTrading.in</h1>
	</section>
	<a class="btn btn--primary full-width" href="https://t.me/Equity_Hedge">Subscribe Ready Strategy</a>
	<a class="btn btn--primary full-width" href="https://www.ezeetrading.in">Home Page</a>
	

	<hr>
	
	<section>
		<pre style="color:white;">Forming Candles in python using Zerodha Websocket</pre>
		<p style="color:white;"> Simply put below light weight code in your websocket on_ticks callback and it will do very light-weight in memory candle formation without blocking your primary thread.
			If you want to do any further processing like saving to database, indicators, signals generation, do that in a seperate thread.
		<pre> 
			for tick in ticks:
			
				...
				...
				...

				### Credits www.EzeeTrading.in

				instrument=tick["instrument_token"]
				ltt=tick["last_trade_time"]
			
				ltt_min_1=datetime.datetime(ltt.year, ltt.month, ltt.day, ltt.hour,ltt.minute)

				# For any other timeframe. Simply change ltt_min_1 variable defination.
				# e.g.
				# ltt_min_15=datetime.datetime(ltt.year, ltt.month, ltt.day, ltt.hour,ltt.minute//15*15)

				### Forming 1 Min Candles...

				try:
						if ltt_min_1 in candles_1[instrument]:
								candles_1[instrument][ltt_min_1]["high"]=max(candles_1[instrument][ltt_min_1]["high"],tick["last_price"]) #1
								candles_1[instrument][ltt_min_1]["volume"]=max(candles_1[instrument][ltt_min_1]["volume"],tick["volume"]) #1.5 Use the max in volume instead of last.
								candles_1[instrument][ltt_min_1]["low"]=min(candles_1[instrument][ltt_min_1]["low"],tick["last_price"]) #2
								candles_1[instrument][ltt_min_1]["close"]=tick["last_price"] #3
								#candles_1[instrument][ltt_min_1]["volume"]=tick["volume"] #3.5
						else:
								candles_1[instrument][ltt_min_1]={}
								candles_1[instrument][ltt_min_1]["high"]=tick["last_price"] #4
								candles_1[instrument][ltt_min_1]["low"]=tick["last_price"] #5
								candles_1[instrument][ltt_min_1]["open"]=tick["last_price"] #6
								candles_1[instrument][ltt_min_1]["close"]=tick["last_price"] #7
								candles_1[instrument][ltt_min_1]["volume"]=tick["volume"] #3.5
				except KeyError:
						if instrument not in candles_1:
								candles_1[instrument]={}
						if ltt_min_1 not in candles_1[instrument]:
								candles_1[instrument][ltt_min_1]={}
						candles_1[instrument][ltt_min_1]["high"]=tick["last_price"] #8
						candles_1[instrument][ltt_min_1]["low"]=tick["last_price"] #9
						candles_1[instrument][ltt_min_1]["open"]=tick["last_price"] #10
						candles_1[instrument][ltt_min_1]["close"]=tick["last_price"] #11
						candles_1[instrument][ltt_min_1]["volume"]=tick["volume"] #3.5
		
		</pre>
		</p>
		
	</section>
	
	
	
	
</div>


<script src="Trade_files/publisher.js"></script>
<!--<script src="https://kite.trade/publisher.js?v=3"></script>-->


<footer>
	<div class="mini-container">
		<div class="text-small disclaimer">
			<p>
				DISCLAIMER: Capital markets, trading, and investments have inherent 
risks. Please make sure you understand the risks involved and carefully 
read the Risk Disclosure Document as prescribed by SEBI | ICF before 
participating in the markets â€” 

			<!--<a href="https://kite.trade/terms">Read terms &amp; conditions</a>-->
			</p>
			
		</div>
	</div>

<!-- Google Analytics -->
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-29026012-7', 'auto');
	ga('send', 'pageview');
</script>

</footer>


<link rel="stylesheet" href="Trade_files/publisher.css"><link rel="stylesheet" href="Trade_files/publisher_002.css"></body></html>